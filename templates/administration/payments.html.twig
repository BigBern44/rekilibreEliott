<form class="col-12" action="{{path('payments')}}" method="get">
	<div class="row mb-2 justify-content-center">
		<div class="col-3 pl-0">
			<button class="btn btn-primary btn-block" data-target="#modalFormPayment" data-toggle="modal" type="button">Ajouter un paiement</button>
		</div>
		<div class="col-3 pl-0">
			<button class="btn btn-primary btn-block" data-target="#modalFormParameters" data-toggle="modal" type="button">Paramétrer les paiements</button>
		</div>
		<div class="col-3 pl-0">
			<div class='row'>
				<div class='col-1 pt-2'>
					Du
				</div>
				<div class='col-5'>
					<input type='text' class='form-control' name='fromDate' value='{{fromDate|date('d/m/Y')}}'/>
				</div>
				<div class='col-1 pt-2'>
					au
				</div>
				<div class='col-5'>
					<input type='text' class='form-control' name='toDate' value='{{toDate|date('d/m/Y')}}'/>
				</div>
			</div>
		</div>
		<div class="row col-6 navigation text-right pr-0">
			<div class="input-group mb-2">
				<input name="search" aria-label="Recherche" class="form-control" placeholder="Recherche par nom" type="text" value="{{search}}"/>
				<div class="input-group-prepend p-0 m-0 mx-2">
					<button type="submit" class="btn btn-block p-0 m-0 mx-2" name='submit' value='search'>
						<div class="input-group-text" class="p-0 m-0">
							<i class="fas fa-check text-success text-l m-0 p-0" data-toggle="tooltip" data-placement="left" title="Rechercher"></i>
						</div>
					</button>
					<button type="submit" class="btn btn-block p-0 m-0 mx-2" name='submit' value='export'>
						<div class="input-group-text" class="p-0 m-0">
							<i class="far fa-file-pdf text-success text-l m-0 p-0" data-toggle="tooltip" data-placement="left" title="Exporter"></i>
						</div>
					</button>
					<a href="{{path('payments')}}" class='mx-2'>
						<div class="input-group-text">
							<i class="fas fa-times text-danger text-l" data-toggle="tooltip" data-placement="left" title="Annuler"></i>
						</div>
					</a>
				</div>
			</div>
		</div>
	</div>
</form>

<table class="table table-striped table-secondary">
	<thead class="bg-primary text-white ">
		<tr>
			<th scope="col">Utilisateur</th>
			<th scope="col">Date</th>
			<th scope="col">Type</th>
			<th scope="col">Valeur €</th>
			<th scope="col">Actions</th>
		</tr>
	</thead>
	<tbody>
		{% for payment in payments %}
			<tr>
				<th scope="row">{{payment.user.displayName}}</th>
				<td>{{payment.date|date('d/m/Y')}}</td>
				<td>{{payment.type}}</td>
				<td>{{payment.value}}</td>
				<td>
					<a data-target="#modalFormPayment{{payment.id}}" data-toggle="modal" href="#">
						<i class="far fa-edit text-primary text-l m-1" data-placement="left" data-toggle="tooltip" title="Modifier"></i>
					</a>
					<a href="{{path('delete_payment',{'id':payment.id,'page':page,'search':search,'fromDate':fromDate|date('d/m/Y'),'toDate':toDate|date('d/m/Y')})}}" onclick="return confirm('Confirmer la suppression ?');">
						<i class="far fa-minus-square text-danger text-l m-1" data-toggle="tooltip" data-placement="left" title="Supprimer"></i>
					</a>
				</td>
			</tr>
		{% endfor %}
	</tbody>
</table>

<div class="row mt-2 justify-content-center">
	<div class="col navigation text-left">
		{{ knp_pagination_render(payments) }}
	</div>
</div>

{% include 'modal/payments/add.html.twig' %}

{% include 'modal/payments/parametrage.html.twig' %}

{% for formModifyPayment in formModifyPayments %}
	{% include 'modal/payments/modify.html.twig' with {'id': formModifyPayment.vars.value.id} %}
{% endfor %}
